<div>
    <form *ngIf="appointmentForm" [formGroup]="appointmentForm" (ngSubmit)="onSubmit()">

        <!-- Dynamic Form Fields -->
        <div *ngFor="let key of roleFields[userRole]" class="mb-3">
            <label class="form-label">{{ key | titlecase }}</label>

            <!-- Select Input -->
            <select *ngIf="fieldConfig[key].type === 'select'" class="form-select" [formControlName]="key">
                <option value="">{{ fieldConfig[key].placeholder }}</option>
                <option *ngFor="let option of fieldConfig[key].options" [value]="option">{{ option }}</option>
            </select>

            <!-- Other Input Types -->
            <input *ngIf="fieldConfig[key].type !== 'select'" [type]="fieldConfig[key].type" class="form-control"
                [formControlName]="key" [placeholder]="fieldConfig[key].placeholder"
                [ngClass]="{'is-invalid': appointmentForm.get(key)?.invalid && appointmentForm.get(key)?.touched}">

            <!-- Error Messages -->
            <div *ngIf="appointmentForm.get(key)?.invalid && appointmentForm.get(key)?.touched"
                class="text-danger small">
                <span *ngFor="let error of fieldConfig[key].errors | keyvalue">
                    <span *ngIf="appointmentForm.get(key)?.errors?.[error.key]">{{ error.value }}</span>
                </span>
            </div>
        </div>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary w-100 mt-3" 
        [disabled]="isRescheduleMode ? (!appointmentForm.valid || isSameAsOriginal()) : !appointmentForm.valid">
        {{ isRescheduleMode ? 'Reschedule Appointment' : 'Book Appointment' }}
    </button>
    </form>

</div>